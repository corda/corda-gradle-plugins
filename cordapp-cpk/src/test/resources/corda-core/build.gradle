import org.jetbrains.kotlin.gradle.tasks.KotlinCompile
import static org.gradle.api.JavaVersion.VERSION_1_8

plugins {
    id 'org.jetbrains.kotlin.jvm'
    id 'biz.aQute.bnd.builder'
    id 'java-library'
}

group = 'net.corda'
version = '5.0.0'

// Share the source files, but not the output files.
buildDir = rootProject.file("cordaBuild")

repositories {
    mavenCentral()
}

kotlin {
    sourceCompatibility = VERSION_1_8
    targetCompatibility = VERSION_1_8
}

dependencies {
    compileOnly "org.osgi:osgi.annotation:$osgi_version"
    implementation "org.jetbrains.kotlin:kotlin-osgi-bundle:$kotlin_version"
    runtimeOnly "com.google.guava:guava:$corda_guava_version"
}

tasks.withType(KotlinCompile).configureEach {
    kotlinOptions {
        jvmTarget = VERSION_1_8
        apiVersion = '1.3'
        languageVersion = '1.3'
        freeCompilerArgs = ['-Xjvm-default=enable']
    }
}

tasks.named('jar', Jar) {
    bnd """\
Bundle-SymbolicName: net.corda.core
Bundle-Name: Fake Corda Core
"""
}
